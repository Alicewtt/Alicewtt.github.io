
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-COMPATIBLE" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>2次补充升级版作业</title>
    <link rel="stylesheet" href="css/bootstrap.css">

    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <script src="js/jquery-1.9.0.min.js"></script>


    <style>
        body{
            padding-top: 70px;
        }
        .navbar-brand img{
            margin-top: -22px;
        }
        .btn-warning{
            margin-left: 20px;
        }
        .dropdown-header{
            color: #0000ff;
            font-size: 20px;
            font-weight: bold;
        }
        .thumbnail img{
            width: 150px;
            height: 50px;
            cursor: pointer;
        }
        /*轮播图片的修饰*/
        .carousel-inner .item>img{
            width: 100% !important;/*优先级最高*/
            width: 100px;
            height: 400px;

        }
    </style>
</head>
<body>
<!--顶部导航栏-->
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#my-menu">
            <!--icon-bar:线，默认在右边-->
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <!--LOGO-->
        <div class="navbar-header">
            <div class="navbar-brand"><!--保存图片-->
                <img src="img/j_logo.gif">
            </div>
        </div>
        <!--菜单-->
        <div class="collapse navbar-collapse" id="my-menu">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">Home</a></li>
                <li class="dropdown">
                    <a href="#" data-toggle="dropdown">News<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Domestic</a></li>
                        <li><a href="#">Intemational</a></li>
                        <li><a href="#">Sports</a></li>
                        <li><a href="#">Ecomonics</a></li>
                    </ul>
                </li>
                <li><a href="#">Contact</a></li>
            </ul>
            <!--搜索框 -->
            <form class="navbar-form navbar-left">
                <div class="form-group input-group">
                    <label class="sr-only">搜索关键字</label>
                    <input type="text" class="form-control" placeholder="keywords">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default">
                                        <span  class="glyphicon glyphicon-search"></span>
                                    </button>
                                </span>
                </div>
            </form>
            <!--按钮-->
            <button class="btn btn-warning btn-sm navbar-btn navbar-right"
                    data-target="#my-login" data-toggle="modal">Login</button>
            <button type="button" class="btn btn-info btn-sm navbar-btn navbar-right"
                data-target="#my-register" data-toggle="modal">Register</button>
        </div>
    </div>
</div>
<!--第一部分的显示，上下关系-->
<div id="body-connect"></div>
<!--第二部分的显示，上下关系-->
<div id="body-second"></div>

<!--登录的模态框-->
<div class="modal fade" id="my-login">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1>聚美优品欢迎您,请登录</h1>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <form>
                        <div class="form-group">
                            <label class="control-label" for="uname1">用户名</label>
                            <input type="text" placeholder="金主粑粑..." name="uname1"
                                   id="uname1" class="form-control" autofocus>
                            <p class="help-block">用户名可以包含数字、字母、下划线</p>
                        </div>
                        <div class="form-group">
                            <label class="control-label" for="password1">密码</label>
                            <input type="password" placeholder="密码=>Money..." name="password1"
                                   id="password1" class="form-control">
                            <p class="help-block">密码长度为6~12,包含数字、下划线</p>
                            <label for="togglePassword1" style="float: right;margin-left: 10px;"><input type="checkbox" id="togglePassword1">显示密码</label>
                            <label for="remember1" style="float: right"><input type="checkbox" id="remember1">记住密码</label>

                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success">确定</button>
                <button class="btn btn-danger">取消</button>
            </div>
        </div>
    </div>
</div>
<!--注册的模态框-->
<div class="modal fade" id="my-register" >
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1>欢迎来到聚美优品,请注册</h1>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <form>
                        <div class="form-group">
                            <label class="control-label" for="uname">用户名</label>
                            <input type="text" placeholder="金主粑粑..." name="uname"
                                   id="uname" class="form-control" autofocus>
                            <p class="help-block">用户名可以包含数字、字母、下划线</p>
                        </div>
                        <div class="form-group">
                            <label class="control-label" for="password">密码</label>
                            <input type="password" placeholder="密码=>Money..." name="password"
                                   id="password" class="form-control">
                            <p class="help-block">密码长度为6~12,包含数字、下划线</p>
                            <label for="togglePassword" style="float: right;margin-left: 10px;"><input type="checkbox" id="togglePassword">显示密码</label>
                            <label for="remember" style="float: right"><input type="checkbox" id="remember">记住密码</label>


                        </div>
                        <div class="form-group" style="margin-top:20px">
                            <label>
                                <input type="checkbox" onclick="document.getElementById('register_btn').disabled=!this.checked" id="checkbox">我同意本站的使用条款
                            </label>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success"
                        disabled="disabled" id="register_btn">提交</button>
                <button class="btn btn-danger">取消</button>
            </div>
        </div>
    </div>
</div>

<script src="js/jquery-1.11.3.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/jquery.toggle-password.js"></script>
<script>
    //注册的异步请求
    //判断用户名是否可以注册，需要异步查询数据库，如果未查询到，那么提示此用户名可注册
    $("#uname").blur(function(){
        //发生ajax请求，验证用户名是否可用
        //        判断用户名是否符合要求:10个字符以内的字母、数字或者下划线的组合
        //        alert("注册的提示");
        var uname=$("#uname").val();
        if(uname==""){
            $("#uname").siblings(".help-block").text("长点心吧,用户名不能为空");
            $("#uname").parent().addClass("has-error");
        }else if(uname.length>10){
            $("#uname").siblings(".help-block").text("大长脸不好看！");
            $("#uname").parent().addClass("has-error");
        }else{
            var regexp=/^\w{1,10}$/;
            var b=regexp.test(uname);
            if(b==true){
                $.getJSON('submit_name.php',{uname:uname}, function (data) {
                    if(data.code==0){
                        $("#uname").siblings(".help-block").text("您真能,可注册");
                        $("#uname").parent().removeClass("has-error").addClass("has-success");
                    }else if(data.code==1){
                        $("#uname").siblings(".help-block").text("已经有人先你一步");
                        $("#uname").parent().addClass("has-error");
                    };
                })
            }else{
                $("#uname").siblings(".help-block").text("不能有汉字，我们要国际化");
                $("#uname").parent().addClass("has-error");
            }
        }
    });
    //注册时判断密码是否符合要求:6~12个字符以内的字母、数字或者下划线的组合
    //判断密码是否符合要求
    $("#password").blur(function(){
        var pwd=$("#password").val();
        if(pwd==""){
            $("#password").siblings(".help-block").text("你看看看看，密码不能为空");
            $("#password").parent().addClass("has-error");
        }else{
            var regexp1=/^\d{6,12}$/;
            var regexp2=/^\w{6,12}$/;
            var d1=regexp1.test(pwd);
            var d2=regexp2.test(pwd);
            if(d1==true){
                $("#password").siblings(".help-block").html("密码太简单不安全,请设置again" +
                        "<button class='btn btn-warning' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-warning' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-warning' style='padding: 5px 7px;margin-left: 5px'></button>");
                $("#password").parent().removeClass("has-error").removeClass("has-success").addClass("has-warning");
            }else if(d2==true){
                $("#password").siblings(".help-block").html("密码安全级别高,请牢记" +
                        "<button class='btn btn-success' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-success' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-success' style='padding: 5px 7px;margin-left: 5px'></button>");
                $("#password").parent().removeClass("has-error").removeClass("has-warning").addClass("has-success");
            }else{
                $("#password").siblings(".help-block").html("密码设置不合格,请设置again" +
                        "<button class='btn btn-danger' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-danger' style='padding: 5px 7px;margin-left: 5px'></button>" +
                        "<button class='btn btn-danger' style='padding: 5px 7px;margin-left: 5px'></button>");
                $("#password").parent().removeClass("has-success").removeClass("has-warning").addClass("has-error");
            }
        }
    });

    //登录的异步请求
    //判断用户名是否可以登录，需要异步查询数据库，如果未查询到，那么提示此用户名需要进行注册
    $("#uname1").blur(function(){
        var uname=$("#uname1").val();
        $.getJSON('submit_name.php',{uname:uname}, function (data) {
            if(data.code==0){
                $("#uname1").siblings(".help-block").text("来了留个脚印，前边请注册");
                $("#uname1").parent().addClass("has-error");
            }else if(data.code==1){
                $("#uname1").siblings(".help-block").text("哈哈哈，来对了...");
                $("#uname1").parent().removeClass("has-error").addClass("has-success");
            };
        });
    });
    //登录时判断密码是否一致和设置的
    $("#password1").blur(function(){
        var pwd=$("#password1").val();
        $.getJSON('submit_pwd.php',{pwd:pwd}, function (data) {
            if(data.code==0){
                $("#password1").siblings(".help-block").text("呃呃呃，You are wrong");
                $("#password1").parent().addClass("has-error");
            }else if(data.code==1){
                $("#password1").siblings(".help-block").text("呦呦呦，您还记得呢");
                $("#password1").parent().removeClass("has-error").addClass("has-success");
            };
        })
    });

    //注册提交按钮处理
    $("button:contains('提交')").click(function(){
        //        判断用户名是否符合要求:10个字符以内的字母、数字或者下划线的组合
        var uname=$("#uname").val();
        var pwd=$("#password").val();
        var msg1=$("#uname").siblings(".help-block").text();
        var msg2=$("#password").siblings(".help-block").text();
        if(msg1=="您真能,可注册"&&msg2=="密码安全级别高,请牢记"){
            $.getJSON('register.php',{uname:uname,pwd:pwd}, function (data) {
                if(data.code==1){
                    alert("恭喜您注册成功，点此进入主页");
                    //恢复注册页面原样
                    $("#uname").val("");
                    $("#password").val("");
                    $("#checkbox").removeAttr("checked");
                    $("#uname").parent().removeClass("has-success");
                    $("#password").parent().removeClass("has-success");
                    $("#uname").siblings(".help-block").text("用户名可以包含数字、字母、下划线");
                    $("#password").siblings(".help-block").text("密码长度为6~12,包含数字、下划线");
                    $("#my-register").modal("hide");
                    $("#body-connect").load("body_after.php");
                    $("#body-second").load("body_second_after.php");
                };
            });
        }else{
            alert("请检查您的用户信息是否填写正确");
        };
    });
    //登录确定按钮处理
    $("button:contains('确定')").click(function(){
        var uname=$("#uname1").val();
        var pwd=$("#password1").val();
        $.getJSON('login.php', {uname:uname,pwd:pwd}, function (data) {
            if(data.code==1){
                alert("恭喜您登录成功，点此进入主页");
                //恢复登录页面原样
                $("#uname1").val("");
                $("#password1").val("");
                $("#uname1").parent().removeClass("has-success");
                $("#password1").parent().removeClass("has-success");
                $("#uname1").siblings(".help-block").text("用户名可以包含数字、字母、下划线");
                $("#password1").siblings(".help-block").text("密码长度为6~12,包含数字、下划线");
                $("#my-login").modal("hide");
                $("#body-connect").load("body_after.php");
                $("#body-second").load("body_second_after.php");
            }else{
                alert("您的用户名或密码输入错误，请重新输入");
            };
        });
    });
    //点击取消处理事件
    $("button:contains('取消')").click(function(){
        //modal('hide'):慢慢隐藏
        $("#my-login").modal("hide");
        $("#my-register").modal("hide");
    });
    //参加活动的处理事件
//    $.each($("button:contains('了解详情')"),function(i,e){
//        console.log(i);
//        console.log(e);
//        alert("触发了解详情事件");
////            var img=$(this).siblings("img");
////            console.log(img);
////            $(this).siblings("img").css({
////                width:600,
////                height:500
////            });
//    });

    //注册时密码的显示
    $(function(){
        $('#password').togglePassword({
            el: '#togglePassword'
        });
        //登录的显示密码
        $('#password1').togglePassword({
            el: '#togglePassword1'
        });
    });
</script>

</body>
</html>